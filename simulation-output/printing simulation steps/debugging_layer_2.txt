~~~~~~~STARTING SIMULATION~~~~
Properties:E0=1,N_sim=10,n_hvl=5,w_min=0.01
   ----dimensions: ac0=0.7721;hvl0=0.8977;d=4.4885 (n_hvl*0.8977)

---------simulating photon number 0
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,layer=1
next photon to simulate: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,cl=1
 NO INTERACTION as: s_free > lam (1.5108630215019294 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
next photon to simulate: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (1.8894736945515158 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=3)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 2: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
next photon to simulate: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 interaction takes place! as: s_free<lam (0.2898067702782124 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 48.3859257691846 % of initial energy!; E_abs = 0.258070371154077
 ---photons to simulate (#=3)--:
   - photon num. 0: E=1,pos=[2.8980677e-01 2.0851981e-13 2.0851981e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=1,pos=[2.8980677e-01 2.0851981e-13 2.0851981e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 2: E=0.483859257691846,pos=[2.8980677e-01 2.0851981e-13 2.0851981e-13],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.5,layer=2
next photon to simulate: E=1,pos=[2.8980677e-01 2.0851981e-13 2.0851981e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (1.3295485094154305 vs 0.6078888959379043)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=4)--:
   - photon num. 0: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=0.483859257691846,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.5,layer=2
   - photon num. 2: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 3: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
next photon to simulate: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (1.3735022317310557 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=5)--:
   - photon num. 0: E=0.483859257691846,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 3: E=1,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 4: E=1,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
next photon to simulate: E=0.483859257691846,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (3.1327931862622407 vs 1.973357492169169)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=6)--:
   - photon num. 0: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 3: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 4: E=0.483859257691846,pos=[ 0.         -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
   - photon num. 5: E=0.483859257691846,pos=[ 0.         -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
next photon to simulate: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (0.9994622858108676 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=7)--:
   - photon num. 0: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 3: E=0.483859257691846,pos=[ 0.         -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
   - photon num. 4: E=0.483859257691846,pos=[ 0.         -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
   - photon num. 5: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 6: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (2.7198457437099783 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=8)--:
   - photon num. 0: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=0.483859257691846,pos=[ 0.         -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
   - photon num. 3: E=0.483859257691846,pos=[ 0.         -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
   - photon num. 4: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 6: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 7: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.         -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.18197030704055356 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 85.07445877479545 % of initial energy!; E_abs = 0.01865692653150569
 ---photons to simulate (#=8)--:
   - photon num. 0: E=1,pos=[ 0.18197031 -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=0.483859257691846,pos=[ 0.18197031 -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
   - photon num. 2: E=0.483859257691846,pos=[ 0.18197031 -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
   - photon num. 3: E=1,pos=[ 0.18197031 -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=1,pos=[ 0.18197031 -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=1,pos=[ 0.18197031 -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 6: E=1,pos=[ 0.18197031 -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 7: E=0.8507445877479545,pos=[ 0.18197031 -1.6383317  -0.63572912],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.125,layer=4
next photon to simulate: E=1,pos=[ 0.18197031 -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.09523938458527774 vs 0.715725359175563)
Photon experiences Compoton scattering, preserves 54.368734502701024 % of initial energy!; E_abs = 0.05703908187162372
 ---photons to simulate (#=8)--:
   - photon num. 0: E=0.483859257691846,pos=[ 0.27720969 -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
   - photon num. 1: E=0.483859257691846,pos=[ 0.27720969 -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
   - photon num. 2: E=1,pos=[ 0.27720969 -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[ 0.27720969 -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=1,pos=[ 0.27720969 -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=1,pos=[ 0.27720969 -1.6383317  -0.63572912],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 6: E=0.8507445877479545,pos=[ 0.27720969 -1.6383317  -0.63572912],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.125,layer=4
   - photon num. 7: E=0.5436873450270102,pos=[ 0.27720969 -1.6383317  -0.63572912],dir=[0.57112159 0.70612094 0.41858495],w=0.125,layer=4
next photon to simulate: E=0.483859257691846,pos=[ 0.27720969 -1.6383317  -0.63572912],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.05051708888498167 vs 1.3639819070362416)
Photon is absorbed via photoeffect! (E_abs =0.1209648144229615)
 ---photons to simulate (#=7)--:
   - photon num. 0: E=0.483859257691846,pos=[ 0.30019031 -1.68027228 -0.65200351],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,layer=3
   - photon num. 1: E=1,pos=[ 0.30019031 -1.68027228 -0.65200351],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[ 0.30019031 -1.68027228 -0.65200351],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[ 0.30019031 -1.68027228 -0.65200351],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=1,pos=[ 0.30019031 -1.68027228 -0.65200351],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=0.8507445877479545,pos=[ 0.30019031 -1.68027228 -0.65200351],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.125,layer=4
   - photon num. 6: E=0.5436873450270102,pos=[ 0.30019031 -1.68027228 -0.65200351],dir=[0.57112159 0.70612094 0.41858495],w=0.125,layer=4
next photon to simulate: E=0.483859257691846,pos=[ 0.30019031 -1.68027228 -0.65200351],dir=[ 0.45490778 -0.8302255  -0.32215609],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.042232641281274755 vs 1.3134648181512596)
Photon experiences Compoton scattering, preserves 77.79496171663615 % of initial energy!; E_abs = 0.026860283352018628
 ---photons to simulate (#=7)--:
   - photon num. 0: E=1,pos=[ 0.31940227 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[ 0.31940227 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[ 0.31940227 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[ 0.31940227 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=0.8507445877479545,pos=[ 0.31940227 -1.71533489 -0.66560901],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.125,layer=4
   - photon num. 5: E=0.5436873450270102,pos=[ 0.31940227 -1.71533489 -0.66560901],dir=[0.57112159 0.70612094 0.41858495],w=0.125,layer=4
   - photon num. 6: E=0.37641812428377147,pos=[ 0.31940227 -1.71533489 -0.66560901],dir=[ 0.86939316 -0.44686548  0.21087147],w=0.25,layer=3
next photon to simulate: E=1,pos=[ 0.31940227 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 interaction takes place! as: s_free<lam (0.1263158157001738 vs 0.5782934012003316)
Photon experiences Compoton scattering, preserves 53.05929704056703 % of initial energy!; E_abs = 0.029337939349645605
 ---photons to simulate (#=7)--:
   - photon num. 0: E=1,pos=[ 0.44571808 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[ 0.44571808 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[ 0.44571808 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=0.8507445877479545,pos=[ 0.44571808 -1.71533489 -0.66560901],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.125,layer=4
   - photon num. 4: E=0.5436873450270102,pos=[ 0.44571808 -1.71533489 -0.66560901],dir=[0.57112159 0.70612094 0.41858495],w=0.125,layer=4
   - photon num. 5: E=0.37641812428377147,pos=[ 0.44571808 -1.71533489 -0.66560901],dir=[ 0.86939316 -0.44686548  0.21087147],w=0.25,layer=3
   - photon num. 6: E=0.5305929704056703,pos=[ 0.44571808 -1.71533489 -0.66560901],dir=[ 0.54792655 -0.45748601  0.70034495],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.44571808 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.7235914827962551 vs 0.45197758550015776)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=6)--:
   - photon num. 0: E=1,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=0.8507445877479545,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.125,layer=4
   - photon num. 3: E=0.5436873450270102,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[0.57112159 0.70612094 0.41858495],w=0.125,layer=4
   - photon num. 4: E=0.37641812428377147,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[ 0.86939316 -0.44686548  0.21087147],w=0.25,layer=3
   - photon num. 5: E=0.5305929704056703,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[ 0.54792655 -0.45748601  0.70034495],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (1.807387410514365 vs 0.0)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=5)--:
   - photon num. 0: E=1,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=0.8507445877479545,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.125,layer=4
   - photon num. 2: E=0.5436873450270102,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[0.57112159 0.70612094 0.41858495],w=0.125,layer=4
   - photon num. 3: E=0.37641812428377147,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[ 0.86939316 -0.44686548  0.21087147],w=0.25,layer=3
   - photon num. 4: E=0.5305929704056703,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[ 0.54792655 -0.45748601  0.70034495],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (2.1415695465635705 vs 0.0)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=4)--:
   - photon num. 0: E=0.8507445877479545,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.125,layer=4
   - photon num. 1: E=0.5436873450270102,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[0.57112159 0.70612094 0.41858495],w=0.125,layer=4
   - photon num. 2: E=0.37641812428377147,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[ 0.86939316 -0.44686548  0.21087147],w=0.25,layer=3
   - photon num. 3: E=0.5305929704056703,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[ 0.54792655 -0.45748601  0.70034495],w=0.0625,layer=5
next photon to simulate: E=0.8507445877479545,pos=[ 0.89769567 -1.71533489 -0.66560901],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (4.64337514131801 vs 0.0)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=5)--:
   - photon num. 0: E=0.5436873450270102,pos=[ 0.         -1.71533489 -0.66560901],dir=[0.57112159 0.70612094 0.41858495],w=0.125,layer=4
   - photon num. 1: E=0.37641812428377147,pos=[ 0.         -1.71533489 -0.66560901],dir=[ 0.86939316 -0.44686548  0.21087147],w=0.25,layer=3
   - photon num. 2: E=0.5305929704056703,pos=[ 0.         -1.71533489 -0.66560901],dir=[ 0.54792655 -0.45748601  0.70034495],w=0.0625,layer=5
   - photon num. 3: E=0.8507445877479545,pos=[ 0.         -1.71533489 -0.66560901],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,layer=5
   - photon num. 4: E=0.8507445877479545,pos=[ 0.         -1.71533489 -0.66560901],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,layer=5
next photon to simulate: E=0.5436873450270102,pos=[ 0.         -1.71533489 -0.66560901],dir=[0.57112159 0.70612094 0.41858495],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (1.6010164141699461 vs 1.5718118339518392)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=6)--:
   - photon num. 0: E=0.37641812428377147,pos=[ 0.         -0.60544565 -0.00767224],dir=[ 0.86939316 -0.44686548  0.21087147],w=0.25,layer=3
   - photon num. 1: E=0.5305929704056703,pos=[ 0.         -0.60544565 -0.00767224],dir=[ 0.54792655 -0.45748601  0.70034495],w=0.0625,layer=5
   - photon num. 2: E=0.8507445877479545,pos=[ 0.         -0.60544565 -0.00767224],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,layer=5
   - photon num. 3: E=0.8507445877479545,pos=[ 0.         -0.60544565 -0.00767224],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,layer=5
   - photon num. 4: E=0.5436873450270102,pos=[ 0.         -0.60544565 -0.00767224],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
   - photon num. 5: E=0.5436873450270102,pos=[ 0.         -0.60544565 -0.00767224],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
next photon to simulate: E=0.37641812428377147,pos=[ 0.         -0.60544565 -0.00767224],dir=[ 0.86939316 -0.44686548  0.21087147],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.019674018754631612 vs 1.032554320781131)
Photon experiences Compoton scattering, preserves 67.29761680060852 % of initial energy!; E_abs = 0.030774424358810146
 ---photons to simulate (#=6)--:
   - photon num. 0: E=0.5305929704056703,pos=[ 0.01710446 -0.61423729 -0.00352355],dir=[ 0.54792655 -0.45748601  0.70034495],w=0.0625,layer=5
   - photon num. 1: E=0.8507445877479545,pos=[ 0.01710446 -0.61423729 -0.00352355],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,layer=5
   - photon num. 2: E=0.8507445877479545,pos=[ 0.01710446 -0.61423729 -0.00352355],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,layer=5
   - photon num. 3: E=0.5436873450270102,pos=[ 0.01710446 -0.61423729 -0.00352355],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
   - photon num. 4: E=0.5436873450270102,pos=[ 0.01710446 -0.61423729 -0.00352355],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
   - photon num. 5: E=0.2533204268485309,pos=[ 0.01710446 -0.61423729 -0.00352355],dir=[0.66845101 0.68052594 0.30009614],w=0.25,layer=3
next photon to simulate: E=0.5305929704056703,pos=[ 0.01710446 -0.61423729 -0.00352355],dir=[ 0.54792655 -0.45748601  0.70034495],w=0.0625,cl=5
 interaction takes place! as: s_free<lam (1.4190356080860171 vs 1.607133658879022)
Photon experiences Compoton scattering, preserves 40.802220438166735 % of initial energy!; E_abs = 0.019631203561958244
 ---photons to simulate (#=6)--:
   - photon num. 0: E=0.8507445877479545,pos=[ 0.79463175 -1.26342622  0.99029086],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,layer=5
   - photon num. 1: E=0.8507445877479545,pos=[ 0.79463175 -1.26342622  0.99029086],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,layer=5
   - photon num. 2: E=0.5436873450270102,pos=[ 0.79463175 -1.26342622  0.99029086],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
   - photon num. 3: E=0.5436873450270102,pos=[ 0.79463175 -1.26342622  0.99029086],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
   - photon num. 4: E=0.2533204268485309,pos=[ 0.79463175 -1.26342622  0.99029086],dir=[0.66845101 0.68052594 0.30009614],w=0.25,layer=3
   - photon num. 5: E=0.2164937134143384,pos=[ 0.79463175 -1.26342622  0.99029086],dir=[ 0.24139045 -0.26960835 -0.93222421],w=0.0625,layer=5
next photon to simulate: E=0.8507445877479545,pos=[ 0.79463175 -1.26342622  0.99029086],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.3409186782960478 vs 0.11321354642317402)
escape on right
  escape on right; E_out=0.053171536734247155
 ---photons to simulate (#=5)--:
   - photon num. 0: E=0.8507445877479545,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,layer=5
   - photon num. 1: E=0.5436873450270102,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
   - photon num. 2: E=0.5436873450270102,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
   - photon num. 3: E=0.2533204268485309,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.66845101 0.68052594 0.30009614],w=0.25,layer=3
   - photon num. 4: E=0.2164937134143384,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[ 0.24139045 -0.26960835 -0.93222421],w=0.0625,layer=5
next photon to simulate: E=0.8507445877479545,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[ 0.91034969 -0.41382568 -0.00342765],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (1.0475288927459936 vs 0.0)
escape on right
  escape on right; E_out=0.053171536734247155
 ---photons to simulate (#=4)--:
   - photon num. 0: E=0.5436873450270102,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
   - photon num. 1: E=0.5436873450270102,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
   - photon num. 2: E=0.2533204268485309,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.66845101 0.68052594 0.30009614],w=0.25,layer=3
   - photon num. 3: E=0.2164937134143384,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[ 0.24139045 -0.26960835 -0.93222421],w=0.0625,layer=5
next photon to simulate: E=0.5436873450270102,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.04710030385870046 vs 0.0)
escape on right
  escape on right; E_out=0.03398045906418814
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.5436873450270102,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,layer=5
   - photon num. 1: E=0.2533204268485309,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.66845101 0.68052594 0.30009614],w=0.25,layer=3
   - photon num. 2: E=0.2164937134143384,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[ 0.24139045 -0.26960835 -0.93222421],w=0.0625,layer=5
next photon to simulate: E=0.5436873450270102,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.57112159 0.70612094 0.41858495],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (2.1154188210654135 vs 0.0)
escape on right
  escape on right; E_out=0.03398045906418814
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.2533204268485309,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.66845101 0.68052594 0.30009614],w=0.25,layer=3
   - photon num. 1: E=0.2164937134143384,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[ 0.24139045 -0.26960835 -0.93222421],w=0.0625,layer=5
next photon to simulate: E=0.2533204268485309,pos=[ 0.89769567 -1.31027689  0.98990281],dir=[0.66845101 0.68052594 0.30009614],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (0.01888018547652623 vs 0.0)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.2164937134143384,pos=[ 0.         -1.31027689  0.98990281],dir=[ 0.24139045 -0.26960835 -0.93222421],w=0.0625,layer=5
   - photon num. 1: E=0.2533204268485309,pos=[ 0.         -1.31027689  0.98990281],dir=[0.66845101 0.68052594 0.30009614],w=0.125,layer=4
   - photon num. 2: E=0.2533204268485309,pos=[ 0.         -1.31027689  0.98990281],dir=[0.66845101 0.68052594 0.30009614],w=0.125,layer=4
next photon to simulate: E=0.2164937134143384,pos=[ 0.         -1.31027689  0.98990281],dir=[ 0.24139045 -0.26960835 -0.93222421],w=0.0625,cl=5
 interaction takes place! as: s_free<lam (0.04407840142394701 vs 3.7188532604086966)
Photon is absorbed via photoeffect! (E_abs =0.01353085708839615)
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.2533204268485309,pos=[ 0.01064011 -1.3221608   0.94881185],dir=[0.66845101 0.68052594 0.30009614],w=0.125,layer=4
   - photon num. 1: E=0.2533204268485309,pos=[ 0.01064011 -1.3221608   0.94881185],dir=[0.66845101 0.68052594 0.30009614],w=0.125,layer=4
next photon to simulate: E=0.2533204268485309,pos=[ 0.01064011 -1.3221608   0.94881185],dir=[0.66845101 0.68052594 0.30009614],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.07828198983562021 vs 1.3270315267069122)
Photon is absorbed via photoeffect! (E_abs =0.03166505335606636)
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.2533204268485309,pos=[ 0.06296778 -1.26888787  0.97230398],dir=[0.66845101 0.68052594 0.30009614],w=0.125,layer=4
next photon to simulate: E=0.2533204268485309,pos=[ 0.06296778 -1.26888787  0.97230398],dir=[0.66845101 0.68052594 0.30009614],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.117403811397496 vs 1.248749536871292)
Photon is absorbed via photoeffect! (E_abs =0.03166505335606636)
-->>Finish simulating 0-th photon


---------simulating photon number 1
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,layer=1
next photon to simulate: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,cl=1
 interaction takes place! as: s_free<lam (0.41389675869131376 vs 0.8976956662161166)
Photon is absorbed via photoeffect! (E_abs =1.0)
-->>Finish simulating 1-th photon


---------simulating photon number 2
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,layer=1
next photon to simulate: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,cl=1
 NO INTERACTION as: s_free > lam (1.140488769762704 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
next photon to simulate: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 interaction takes place! as: s_free<lam (0.7945765470215733 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 88.58986885337772 % of initial energy!; E_abs = 0.05705065573311141
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[7.94576547e-01 1.69227221e-13 1.69227221e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=0.8858986885337772,pos=[7.94576547e-01 1.69227221e-13 1.69227221e-13],dir=[ 0.93418461  0.31100694 -0.17485366],w=0.5,layer=2
next photon to simulate: E=1,pos=[7.94576547e-01 1.69227221e-13 1.69227221e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (1.6344077964637993 vs 0.10311911919454331)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.8858986885337772,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[ 0.93418461  0.31100694 -0.17485366],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 2: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
next photon to simulate: E=0.8858986885337772,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[ 0.93418461  0.31100694 -0.17485366],w=0.5,cl=2
 interaction takes place! as: s_free<lam (0.5326711285062958 vs 0.9609403315887306)
Photon is absorbed via photoeffect! (E_abs =0.4429493442668886)
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[ 0.49761317  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=1,pos=[ 0.49761317  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
next photon to simulate: E=1,pos=[ 0.49761317  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (0.7777916055184358 vs 0.40008249726110284)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=3)--:
   - photon num. 0: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
next photon to simulate: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (1.3145413817448854 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=4)--:
   - photon num. 0: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 3: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
next photon to simulate: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (1.0500218268624906 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=5)--:
   - photon num. 0: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 3: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.288180997485782 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 66.99720807196218 % of initial energy!; E_abs = 0.04125348991004728
 ---photons to simulate (#=5)--:
   - photon num. 0: E=1,pos=[ 0.288181    0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[ 0.288181    0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[ 0.288181    0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[ 0.288181    0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=0.6699720807196218,pos=[ 0.288181    0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.125,layer=4
next photon to simulate: E=1,pos=[ 0.288181    0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (0.9791578425340699 vs 0.6095146687303346)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=6)--:
   - photon num. 0: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=0.6699720807196218,pos=[ 0.          0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.125,layer=4
   - photon num. 4: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (1.1168381573620827 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=7)--:
   - photon num. 0: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=0.6699720807196218,pos=[ 0.          0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.125,layer=4
   - photon num. 3: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 6: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 interaction takes place! as: s_free<lam (0.2593732595837871 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 64.29570913890271 % of initial energy!; E_abs = 0.022315181788185805
 ---photons to simulate (#=7)--:
   - photon num. 0: E=1,pos=[ 0.25937326  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=0.6699720807196218,pos=[ 0.25937326  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.125,layer=4
   - photon num. 2: E=1,pos=[ 0.25937326  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[ 0.25937326  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=1,pos=[ 0.25937326  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=1,pos=[ 0.25937326  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 6: E=0.6429570913890271,pos=[ 0.25937326  0.16566442 -0.0931395 ],dir=[ 0.71623468 -0.10397614 -0.69007018],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.25937326  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (7.777846799421426 vs 0.6383224066323295)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=6)--:
   - photon num. 0: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.125,layer=4
   - photon num. 1: E=1,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=1,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=0.6429570913890271,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.71623468 -0.10397614 -0.69007018],w=0.0625,layer=5
next photon to simulate: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (0.6148590451573347 vs 0.0)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=7)--:
   - photon num. 0: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=0.6429570913890271,pos=[ 0.          0.16566442 -0.0931395 ],dir=[ 0.71623468 -0.10397614 -0.69007018],w=0.0625,layer=5
   - photon num. 5: E=0.6699720807196218,pos=[ 0.          0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 6: E=0.6699720807196218,pos=[ 0.          0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.          0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 interaction takes place! as: s_free<lam (0.33385140365193433 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 94.44719132925495 % of initial energy!; E_abs = 0.003470505419215661
 ---photons to simulate (#=7)--:
   - photon num. 0: E=1,pos=[ 0.3338514   0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[ 0.3338514   0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[ 0.3338514   0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=0.6429570913890271,pos=[ 0.3338514   0.16566442 -0.0931395 ],dir=[ 0.71623468 -0.10397614 -0.69007018],w=0.0625,layer=5
   - photon num. 4: E=0.6699720807196218,pos=[ 0.3338514   0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 5: E=0.6699720807196218,pos=[ 0.3338514   0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 6: E=0.9444719132925494,pos=[ 0.3338514   0.16566442 -0.0931395 ],dir=[ 0.96995691 -0.23034341  0.07826559],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.3338514   0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (2.2655828439664445 vs 0.5638442625641823)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=6)--:
   - photon num. 0: E=1,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=0.6429570913890271,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.71623468 -0.10397614 -0.69007018],w=0.0625,layer=5
   - photon num. 3: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 4: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 5: E=0.9444719132925494,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.96995691 -0.23034341  0.07826559],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (3.3043249085026103 vs 0.0)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=5)--:
   - photon num. 0: E=1,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=0.6429570913890271,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.71623468 -0.10397614 -0.69007018],w=0.0625,layer=5
   - photon num. 2: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 3: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 4: E=0.9444719132925494,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.96995691 -0.23034341  0.07826559],w=0.0625,layer=5
next photon to simulate: E=1,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (1.0487690414134885 vs 0.0)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=4)--:
   - photon num. 0: E=0.6429570913890271,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.71623468 -0.10397614 -0.69007018],w=0.0625,layer=5
   - photon num. 1: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 2: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 3: E=0.9444719132925494,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.96995691 -0.23034341  0.07826559],w=0.0625,layer=5
next photon to simulate: E=0.6429570913890271,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.71623468 -0.10397614 -0.69007018],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.19722416211275917 vs 0.0)
escape on right
  escape on right; E_out=0.040184818211814195
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 1: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 2: E=0.9444719132925494,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.96995691 -0.23034341  0.07826559],w=0.0625,layer=5
next photon to simulate: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.3471834033936657 vs 0.0)
escape on right
  escape on right; E_out=0.04187325504497636
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,layer=5
   - photon num. 1: E=0.9444719132925494,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.96995691 -0.23034341  0.07826559],w=0.0625,layer=5
next photon to simulate: E=0.6699720807196218,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.74828165  0.65016853 -0.13174012],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.4589225220596563 vs 0.0)
escape on right
  escape on right; E_out=0.04187325504497636
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.9444719132925494,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.96995691 -0.23034341  0.07826559],w=0.0625,layer=5
next photon to simulate: E=0.9444719132925494,pos=[ 0.89769567  0.16566442 -0.0931395 ],dir=[ 0.96995691 -0.23034341  0.07826559],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (1.6870775986723938 vs 0.0)
escape on right
  escape on right; E_out=0.05902949458078434
-->>Finish simulating 2-th photon


---------simulating photon number 3
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,layer=1
next photon to simulate: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,cl=1
 interaction takes place! as: s_free<lam (0.6640109068279083 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 38.353394370007166 % of initial energy!; E_abs = 0.6164660562999283
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.38353394370007166,pos=[6.64010907e-01 6.64010907e-14 6.64010907e-14],dir=[ 0.17865378 -0.12638018  0.97576169],w=1.0,layer=1
next photon to simulate: E=0.38353394370007166,pos=[6.64010907e-01 6.64010907e-14 6.64010907e-14],dir=[ 0.17865378 -0.12638018  0.97576169],w=1.0,cl=1
 interaction takes place! as: s_free<lam (0.3022902615306315 vs 1.3080314278443987)
Photon is absorbed via photoeffect! (E_abs =0.38353394370007166)
-->>Finish simulating 3-th photon


---------simulating photon number 4
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,layer=1
next photon to simulate: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,cl=1
 NO INTERACTION as: s_free > lam (0.9401711300106474 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
next photon to simulate: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 interaction takes place! as: s_free<lam (0.6900596939735146 vs 0.8976956662161166)
Photon is absorbed via photoeffect! (E_abs =0.5)
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[6.90059694e-01 1.58775536e-13 1.58775536e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
next photon to simulate: E=1,pos=[6.90059694e-01 1.58775536e-13 1.58775536e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (4.620307265272163 vs 0.207635972242602)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
next photon to simulate: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.08946679524194523 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 39.753032307573704 % of initial energy!; E_abs = 0.15061741923106575
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[8.94667952e-02 1.88485813e-13 1.88485813e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=0.39753032307573705,pos=[8.94667952e-02 1.88485813e-13 1.88485813e-13],dir=[ 0.22556347 -0.32946299  0.91682892],w=0.25,layer=3
next photon to simulate: E=1,pos=[8.94667952e-02 1.88485813e-13 1.88485813e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (1.7780802885995728 vs 0.8082288709741714)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.39753032307573705,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[ 0.22556347 -0.32946299  0.91682892],w=0.25,layer=3
   - photon num. 1: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
next photon to simulate: E=0.39753032307573705,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[ 0.22556347 -0.32946299  0.91682892],w=0.25,cl=3
 interaction takes place! as: s_free<lam (1.2531051961357227 vs 3.979791921023999)
Photon experiences Compoton scattering, preserves 79.94267903801506 % of initial energy!; E_abs = 0.019933483205129072
 ---photons to simulate (#=3)--:
   - photon num. 0: E=1,pos=[ 0.28265475 -0.41285178  1.14888308],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[ 0.28265475 -0.41285178  1.14888308],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=0.3177963902552208,pos=[ 0.28265475 -0.41285178  1.14888308],dir=[ 0.82824185 -0.40152015  0.39089258],w=0.25,layer=3
next photon to simulate: E=1,pos=[ 0.28265475 -0.41285178  1.14888308],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.4631981440405329 vs 0.6150409128503938)
Photon experiences Compoton scattering, preserves 67.02444181305815 % of initial energy!; E_abs = 0.04121944773367732
 ---photons to simulate (#=3)--:
   - photon num. 0: E=1,pos=[ 0.7458529  -0.41285178  1.14888308],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=0.3177963902552208,pos=[ 0.7458529  -0.41285178  1.14888308],dir=[ 0.82824185 -0.40152015  0.39089258],w=0.25,layer=3
   - photon num. 2: E=0.6702444181305814,pos=[ 0.7458529  -0.41285178  1.14888308],dir=[ 0.74859156  0.5599141  -0.3551153 ],w=0.125,layer=4
next photon to simulate: E=1,pos=[ 0.7458529  -0.41285178  1.14888308],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (1.7059790122998344 vs 0.1518427688098608)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=4)--:
   - photon num. 0: E=0.3177963902552208,pos=[ 0.         -0.41285178  1.14888308],dir=[ 0.82824185 -0.40152015  0.39089258],w=0.25,layer=3
   - photon num. 1: E=0.6702444181305814,pos=[ 0.         -0.41285178  1.14888308],dir=[ 0.74859156  0.5599141  -0.3551153 ],w=0.125,layer=4
   - photon num. 2: E=1,pos=[ 0.         -0.41285178  1.14888308],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[ 0.         -0.41285178  1.14888308],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
next photon to simulate: E=0.3177963902552208,pos=[ 0.         -0.41285178  1.14888308],dir=[ 0.82824185 -0.40152015  0.39089258],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.04940484852415716 vs 1.083856927324744)
Photon is absorbed via photoeffect! (E_abs =0.0794490975638052)
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.6702444181305814,pos=[ 0.04091916 -0.43268882  1.16819507],dir=[ 0.74859156  0.5599141  -0.3551153 ],w=0.125,layer=4
   - photon num. 1: E=1,pos=[ 0.04091916 -0.43268882  1.16819507],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[ 0.04091916 -0.43268882  1.16819507],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
next photon to simulate: E=0.6702444181305814,pos=[ 0.04091916 -0.43268882  1.16819507],dir=[ 0.74859156  0.5599141  -0.3551153 ],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.4844418408217833 vs 1.1445179811631279)
Photon experiences Compoton scattering, preserves 64.74849194145804 % of initial energy!; E_abs = 0.029533908133653697
 ---photons to simulate (#=3)--:
   - photon num. 0: E=1,pos=[ 0.40356824 -0.161443    0.99616236],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[ 0.40356824 -0.161443    0.99616236],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=0.43397315306135187,pos=[ 0.40356824 -0.161443    0.99616236],dir=[ 0.65962974 -0.2797003  -0.69760758],w=0.125,layer=4
next photon to simulate: E=1,pos=[ 0.40356824 -0.161443    0.99616236],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (3.495278908040485 vs 0.49412742884365274)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[ 0.89769567 -0.161443    0.99616236],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=0.43397315306135187,pos=[ 0.89769567 -0.161443    0.99616236],dir=[ 0.65962974 -0.2797003  -0.69760758],w=0.125,layer=4
next photon to simulate: E=1,pos=[ 0.89769567 -0.161443    0.99616236],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.6705185985292416 vs 0.0)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.43397315306135187,pos=[ 0.89769567 -0.161443    0.99616236],dir=[ 0.65962974 -0.2797003  -0.69760758],w=0.125,layer=4
next photon to simulate: E=0.43397315306135187,pos=[ 0.89769567 -0.161443    0.99616236],dir=[ 0.65962974 -0.2797003  -0.69760758],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (0.31925063196199066 vs 0.0)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.43397315306135187,pos=[ 0.         -0.161443    0.99616236],dir=[ 0.65962974 -0.2797003  -0.69760758],w=0.0625,layer=5
   - photon num. 1: E=0.43397315306135187,pos=[ 0.         -0.161443    0.99616236],dir=[ 0.65962974 -0.2797003  -0.69760758],w=0.0625,layer=5
next photon to simulate: E=0.43397315306135187,pos=[ 0.         -0.161443    0.99616236],dir=[ 0.65962974 -0.2797003  -0.69760758],w=0.0625,cl=5
 interaction takes place! as: s_free<lam (0.3145798976639954 vs 1.3609084119340673)
Photon is absorbed via photoeffect! (E_abs =0.027123322066334492)
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.43397315306135187,pos=[ 0.20750626 -0.2494311   0.77670904],dir=[ 0.65962974 -0.2797003  -0.69760758],w=0.0625,layer=5
next photon to simulate: E=0.43397315306135187,pos=[ 0.20750626 -0.2494311   0.77670904],dir=[ 0.65962974 -0.2797003  -0.69760758],w=0.0625,cl=5
 interaction takes place! as: s_free<lam (0.48909830906609497 vs 1.0463285142700718)
Photon experiences Compoton scattering, preserves 41.21655854629135 % of initial energy!; E_abs = 0.01594402214716457
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.17886879870671868,pos=[ 0.53013005 -0.38623204  0.43551035],dir=[-0.24383262  0.8893984   0.38667317],w=0.0625,layer=5
next photon to simulate: E=0.17886879870671868,pos=[ 0.53013005 -0.38623204  0.43551035],dir=[-0.24383262  0.8893984   0.38667317],w=0.0625,cl=5
 interaction takes place! as: s_free<lam (0.034268984336108886 vs 2.174155599894828)
Photon is absorbed via photoeffect! (E_abs =0.011179299919169917)
-->>Finish simulating 4-th photon


---------simulating photon number 5
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,layer=1
next photon to simulate: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,cl=1
 interaction takes place! as: s_free<lam (0.24578391035328262 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 96.78919569662504 % of initial energy!; E_abs = 0.03210804303374959
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.9678919569662504,pos=[2.4578391e-01 2.4578391e-14 2.4578391e-14],dir=[ 0.98304851 -0.1811545   0.02826082],w=1.0,layer=1
next photon to simulate: E=0.9678919569662504,pos=[2.4578391e-01 2.4578391e-14 2.4578391e-14],dir=[ 0.98304851 -0.1811545   0.02826082],w=1.0,cl=1
 NO INTERACTION as: s_free > lam (1.1315392157755573 vs 0.6631531899557563)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.         -0.12013318  0.01874125],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.5,layer=2
   - photon num. 1: E=0.9678919569662504,pos=[ 0.         -0.12013318  0.01874125],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.5,layer=2
next photon to simulate: E=0.9678919569662504,pos=[ 0.         -0.12013318  0.01874125],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.5,cl=2
 interaction takes place! as: s_free<lam (0.8416221816239083 vs 0.9131753482076066)
Photon experiences Compoton scattering, preserves 92.7943982545232 % of initial energy!; E_abs = 0.03487121987274484
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.82735543 -0.27259682  0.04252619],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.5,layer=2
   - photon num. 1: E=0.8981495172207608,pos=[ 0.82735543 -0.27259682  0.04252619],dir=[ 0.98533375  0.02685378 -0.16851197],w=0.5,layer=2
next photon to simulate: E=0.9678919569662504,pos=[ 0.82735543 -0.27259682  0.04252619],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (0.54120888663265 vs 0.07155316658369813)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.8981495172207608,pos=[ 0.         -0.285559    0.04454834],dir=[ 0.98533375  0.02685378 -0.16851197],w=0.5,layer=2
   - photon num. 1: E=0.9678919569662504,pos=[ 0.         -0.285559    0.04454834],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.25,layer=3
   - photon num. 2: E=0.9678919569662504,pos=[ 0.         -0.285559    0.04454834],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.25,layer=3
next photon to simulate: E=0.8981495172207608,pos=[ 0.         -0.285559    0.04454834],dir=[ 0.98533375  0.02685378 -0.16851197],w=0.5,cl=2
 interaction takes place! as: s_free<lam (0.8129929674139076 vs 0.9110574661223096)
Photon experiences Compoton scattering, preserves 26.927616784833724 % of initial energy!; E_abs = 0.32814962853436
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.80106941 -0.26372707 -0.0924507 ],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.25,layer=3
   - photon num. 1: E=0.9678919569662504,pos=[ 0.80106941 -0.26372707 -0.0924507 ],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.25,layer=3
   - photon num. 2: E=0.24185026015204064,pos=[ 0.80106941 -0.26372707 -0.0924507 ],dir=[-0.39317075 -0.20670896  0.89592866],w=0.5,layer=2
next photon to simulate: E=0.9678919569662504,pos=[ 0.80106941 -0.26372707 -0.0924507 ],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (1.2169954918274548 vs 0.09829246352153524)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=4)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.         -0.28153319 -0.08967288],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.25,layer=3
   - photon num. 1: E=0.24185026015204064,pos=[ 0.         -0.28153319 -0.08967288],dir=[-0.39317075 -0.20670896  0.89592866],w=0.5,layer=2
   - photon num. 2: E=0.9678919569662504,pos=[ 0.         -0.28153319 -0.08967288],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 3: E=0.9678919569662504,pos=[ 0.         -0.28153319 -0.08967288],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
next photon to simulate: E=0.9678919569662504,pos=[ 0.         -0.28153319 -0.08967288],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (3.6488603950305643 vs 0.9131753482076066)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=5)--:
   - photon num. 0: E=0.24185026015204064,pos=[ 0.         -0.44695901 -0.06386579],dir=[-0.39317075 -0.20670896  0.89592866],w=0.5,layer=2
   - photon num. 1: E=0.9678919569662504,pos=[ 0.         -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 2: E=0.9678919569662504,pos=[ 0.         -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 3: E=0.9678919569662504,pos=[ 0.         -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 4: E=0.9678919569662504,pos=[ 0.         -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
next photon to simulate: E=0.24185026015204064,pos=[ 0.         -0.44695901 -0.06386579],dir=[-0.39317075 -0.20670896  0.89592866],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (0.3668334422071721 vs 0.0)
move to nex layer on left
Photon moves to next layer on left
 ---photons to simulate (#=6)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.89769567 -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 1: E=0.9678919569662504,pos=[ 0.89769567 -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 2: E=0.9678919569662504,pos=[ 0.89769567 -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 3: E=0.9678919569662504,pos=[ 0.89769567 -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 4: E=0.24185026015204064,pos=[ 0.89769567 -0.44695901 -0.06386579],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
   - photon num. 5: E=0.24185026015204064,pos=[ 0.89769567 -0.44695901 -0.06386579],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
next photon to simulate: E=0.9678919569662504,pos=[ 0.89769567 -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (0.23876703760953072 vs 0.0)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=7)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.         -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 1: E=0.9678919569662504,pos=[ 0.         -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 2: E=0.9678919569662504,pos=[ 0.         -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 3: E=0.24185026015204064,pos=[ 0.         -0.44695901 -0.06386579],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
   - photon num. 4: E=0.24185026015204064,pos=[ 0.         -0.44695901 -0.06386579],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
   - photon num. 5: E=0.9678919569662504,pos=[ 0.         -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 6: E=0.9678919569662504,pos=[ 0.         -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
next photon to simulate: E=0.9678919569662504,pos=[ 0.         -0.44695901 -0.06386579],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.8808728150451524 vs 0.9131753482076066)
Photon experiences Compoton scattering, preserves 49.68714172913768 % of initial energy!; E_abs = 0.06087176356543816
 ---photons to simulate (#=7)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.86594071 -0.60653308 -0.0389716 ],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 1: E=0.9678919569662504,pos=[ 0.86594071 -0.60653308 -0.0389716 ],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 2: E=0.24185026015204064,pos=[ 0.86594071 -0.60653308 -0.0389716 ],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
   - photon num. 3: E=0.24185026015204064,pos=[ 0.86594071 -0.60653308 -0.0389716 ],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
   - photon num. 4: E=0.9678919569662504,pos=[ 0.86594071 -0.60653308 -0.0389716 ],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 5: E=0.9678919569662504,pos=[ 0.86594071 -0.60653308 -0.0389716 ],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 6: E=0.4809178484427451,pos=[ 0.86594071 -0.60653308 -0.0389716 ],dir=[ 0.57529699  0.44583374 -0.68575917],w=0.125,layer=4
next photon to simulate: E=0.9678919569662504,pos=[ 0.86594071 -0.60653308 -0.0389716 ],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (3.1924755593109007 vs 0.03230253316245411)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=8)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.         -0.61238483 -0.03805871],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,layer=4
   - photon num. 1: E=0.24185026015204064,pos=[ 0.         -0.61238483 -0.03805871],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
   - photon num. 2: E=0.24185026015204064,pos=[ 0.         -0.61238483 -0.03805871],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
   - photon num. 3: E=0.9678919569662504,pos=[ 0.         -0.61238483 -0.03805871],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 4: E=0.9678919569662504,pos=[ 0.         -0.61238483 -0.03805871],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 5: E=0.4809178484427451,pos=[ 0.         -0.61238483 -0.03805871],dir=[ 0.57529699  0.44583374 -0.68575917],w=0.125,layer=4
   - photon num. 6: E=0.9678919569662504,pos=[ 0.         -0.61238483 -0.03805871],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 7: E=0.9678919569662504,pos=[ 0.         -0.61238483 -0.03805871],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
next photon to simulate: E=0.9678919569662504,pos=[ 0.         -0.61238483 -0.03805871],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (3.940359427839537 vs 0.9131753482076066)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=9)--:
   - photon num. 0: E=0.24185026015204064,pos=[ 0.         -0.77781065 -0.01225162],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
   - photon num. 1: E=0.24185026015204064,pos=[ 0.         -0.77781065 -0.01225162],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
   - photon num. 2: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 3: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 4: E=0.4809178484427451,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.57529699  0.44583374 -0.68575917],w=0.125,layer=4
   - photon num. 5: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 6: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 7: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 8: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
next photon to simulate: E=0.24185026015204064,pos=[ 0.         -0.77781065 -0.01225162],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,cl=1
 NO INTERACTION as: s_free > lam (0.3673083017497663 vs 0.0)
backscatter
  photon bacscatters with E_bs=0.06046256503801016
 ---photons to simulate (#=8)--:
   - photon num. 0: E=0.24185026015204064,pos=[ 0.         -0.77781065 -0.01225162],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,layer=1
   - photon num. 1: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 2: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 3: E=0.4809178484427451,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.57529699  0.44583374 -0.68575917],w=0.125,layer=4
   - photon num. 4: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 5: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 6: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 7: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
next photon to simulate: E=0.24185026015204064,pos=[ 0.         -0.77781065 -0.01225162],dir=[-0.39317075 -0.20670896  0.89592866],w=0.25,cl=1
 NO INTERACTION as: s_free > lam (0.02481337289623723 vs 0.0)
backscatter
  photon bacscatters with E_bs=0.06046256503801016
 ---photons to simulate (#=7)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 1: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 2: E=0.4809178484427451,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.57529699  0.44583374 -0.68575917],w=0.125,layer=4
   - photon num. 3: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 4: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 5: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 6: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
next photon to simulate: E=0.9678919569662504,pos=[ 0.         -0.77781065 -0.01225162],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,cl=5
 interaction takes place! as: s_free<lam (0.10814826268242303 vs 0.9131753482076066)
Photon experiences Compoton scattering, preserves 40.23296250720202 % of initial energy!; E_abs = 0.03615502180061218
 ---photons to simulate (#=7)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.10631499 -0.79740219 -0.00919526],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 1: E=0.4809178484427451,pos=[ 0.10631499 -0.79740219 -0.00919526],dir=[ 0.57529699  0.44583374 -0.68575917],w=0.125,layer=4
   - photon num. 2: E=0.9678919569662504,pos=[ 0.10631499 -0.79740219 -0.00919526],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 3: E=0.9678919569662504,pos=[ 0.10631499 -0.79740219 -0.00919526],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 4: E=0.9678919569662504,pos=[ 0.10631499 -0.79740219 -0.00919526],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 5: E=0.9678919569662504,pos=[ 0.10631499 -0.79740219 -0.00919526],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 6: E=0.3894116081564554,pos=[ 0.10631499 -0.79740219 -0.00919526],dir=[0.24329387 0.27459761 0.93027106],w=0.0625,layer=5
next photon to simulate: E=0.9678919569662504,pos=[ 0.10631499 -0.79740219 -0.00919526],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,cl=5
 interaction takes place! as: s_free<lam (0.052498522552772285 vs 0.8050270855251835)
Photon experiences Compoton scattering, preserves 80.43797458618648 % of initial energy!; E_abs = 0.011833704412499684
 ---photons to simulate (#=7)--:
   - photon num. 0: E=0.4809178484427451,pos=[ 0.15792358 -0.80691254 -0.00771161],dir=[ 0.57529699  0.44583374 -0.68575917],w=0.125,layer=4
   - photon num. 1: E=0.9678919569662504,pos=[ 0.15792358 -0.80691254 -0.00771161],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 2: E=0.9678919569662504,pos=[ 0.15792358 -0.80691254 -0.00771161],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 3: E=0.9678919569662504,pos=[ 0.15792358 -0.80691254 -0.00771161],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 4: E=0.9678919569662504,pos=[ 0.15792358 -0.80691254 -0.00771161],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 5: E=0.3894116081564554,pos=[ 0.15792358 -0.80691254 -0.00771161],dir=[0.24329387 0.27459761 0.93027106],w=0.0625,layer=5
   - photon num. 6: E=0.7785526863662555,pos=[ 0.15792358 -0.80691254 -0.00771161],dir=[ 0.84737887 -0.28310761 -0.44922057],w=0.0625,layer=5
next photon to simulate: E=0.4809178484427451,pos=[ 0.15792358 -0.80691254 -0.00771161],dir=[ 0.57529699  0.44583374 -0.68575917],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.8571636430346501 vs 1.2858959636549407)
Photon is absorbed via photoeffect! (E_abs =0.06011473105534314)
 ---photons to simulate (#=6)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.65104725 -0.42476006 -0.59551944],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 1: E=0.9678919569662504,pos=[ 0.65104725 -0.42476006 -0.59551944],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 2: E=0.9678919569662504,pos=[ 0.65104725 -0.42476006 -0.59551944],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 3: E=0.9678919569662504,pos=[ 0.65104725 -0.42476006 -0.59551944],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 4: E=0.3894116081564554,pos=[ 0.65104725 -0.42476006 -0.59551944],dir=[0.24329387 0.27459761 0.93027106],w=0.0625,layer=5
   - photon num. 5: E=0.7785526863662555,pos=[ 0.65104725 -0.42476006 -0.59551944],dir=[ 0.84737887 -0.28310761 -0.44922057],w=0.0625,layer=5
next photon to simulate: E=0.9678919569662504,pos=[ 0.65104725 -0.42476006 -0.59551944],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (2.8104813677047003 vs 0.25090157077652225)
escape on right
  escape on right; E_out=0.06049324731039065
 ---photons to simulate (#=5)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 1: E=0.9678919569662504,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 2: E=0.9678919569662504,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 3: E=0.3894116081564554,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[0.24329387 0.27459761 0.93027106],w=0.0625,layer=5
   - photon num. 4: E=0.7785526863662555,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.84737887 -0.28310761 -0.44922057],w=0.0625,layer=5
next photon to simulate: E=0.9678919569662504,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.5496472795523787 vs -1.1293674852788077e-16)
escape on right
  escape on right; E_out=0.06049324731039065
 ---photons to simulate (#=4)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 1: E=0.9678919569662504,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 2: E=0.3894116081564554,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[0.24329387 0.27459761 0.93027106],w=0.0625,layer=5
   - photon num. 3: E=0.7785526863662555,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.84737887 -0.28310761 -0.44922057],w=0.0625,layer=5
next photon to simulate: E=0.9678919569662504,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.08893269838317917 vs 0.0)
escape on right
  escape on right; E_out=0.06049324731039065
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.9678919569662504,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,layer=5
   - photon num. 1: E=0.3894116081564554,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[0.24329387 0.27459761 0.93027106],w=0.0625,layer=5
   - photon num. 2: E=0.7785526863662555,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.84737887 -0.28310761 -0.44922057],w=0.0625,layer=5
next photon to simulate: E=0.9678919569662504,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.98304851 -0.1811545   0.02826082],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.08423532538821062 vs 0.0)
escape on right
  escape on right; E_out=0.06049324731039065
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.3894116081564554,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[0.24329387 0.27459761 0.93027106],w=0.0625,layer=5
   - photon num. 1: E=0.7785526863662555,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.84737887 -0.28310761 -0.44922057],w=0.0625,layer=5
next photon to simulate: E=0.3894116081564554,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[0.24329387 0.27459761 0.93027106],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.11231931853096153 vs 0.0)
escape on right
  escape on right; E_out=0.024338225509778464
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.7785526863662555,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.84737887 -0.28310761 -0.44922057],w=0.0625,layer=5
next photon to simulate: E=0.7785526863662555,pos=[ 0.89769567 -0.47021201 -0.58842876],dir=[ 0.84737887 -0.28310761 -0.44922057],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (1.8743041130489302 vs 0.0)
escape on right
  escape on right; E_out=0.04865954289789097
-->>Finish simulating 5-th photon


---------simulating photon number 6
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,layer=1
next photon to simulate: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,cl=1
 NO INTERACTION as: s_free > lam (1.8903040435125096 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
next photon to simulate: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 interaction takes place! as: s_free<lam (0.0928606258949007 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 73.01848438894805 % of initial energy!; E_abs = 0.13490757805525977
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[9.28606259e-02 9.90556292e-14 9.90556292e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=0.7301848438894805,pos=[9.28606259e-02 9.90556292e-14 9.90556292e-14],dir=[ 0.8111772   0.56632324 -0.14584076],w=0.5,layer=2
next photon to simulate: E=1,pos=[9.28606259e-02 9.90556292e-14 9.90556292e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 interaction takes place! as: s_free<lam (0.46032292429212845 vs 0.8048350403212159)
Photon is absorbed via photoeffect! (E_abs =0.5)
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.7301848438894805,pos=[5.53183550e-01 1.45087922e-13 1.45087922e-13],dir=[ 0.8111772   0.56632324 -0.14584076],w=0.5,layer=2
next photon to simulate: E=0.7301848438894805,pos=[5.53183550e-01 1.45087922e-13 1.45087922e-13],dir=[ 0.8111772   0.56632324 -0.14584076],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (0.4843632553298535 vs 0.424706358714522)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.7301848438894805,pos=[ 0.          0.24052108 -0.0619395 ],dir=[ 0.8111772   0.56632324 -0.14584076],w=0.25,layer=3
   - photon num. 1: E=0.7301848438894805,pos=[ 0.          0.24052108 -0.0619395 ],dir=[ 0.8111772   0.56632324 -0.14584076],w=0.25,layer=3
next photon to simulate: E=0.7301848438894805,pos=[ 0.          0.24052108 -0.0619395 ],dir=[ 0.8111772   0.56632324 -0.14584076],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.8692248997661649 vs 1.1066579080785186)
Photon experiences Compoton scattering, preserves 40.0329041749054 % of initial energy!; E_abs = 0.10946766125888055
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.7301848438894805,pos=[ 0.70509542  0.73278335 -0.18870792],dir=[ 0.8111772   0.56632324 -0.14584076],w=0.25,layer=3
   - photon num. 1: E=0.29231419885395826,pos=[ 0.70509542  0.73278335 -0.18870792],dir=[-0.59886105  0.6531675  -0.46339795],w=0.25,layer=3
next photon to simulate: E=0.7301848438894805,pos=[ 0.70509542  0.73278335 -0.18870792],dir=[ 0.8111772   0.56632324 -0.14584076],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.19507508081266733 vs 0.23743300831235367)
Photon experiences Compoton scattering, preserves 41.54027526823405 % of initial energy!; E_abs = 0.1067160124427163
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.29231419885395826,pos=[ 0.86333588  0.8432589  -0.21715782],dir=[-0.59886105  0.6531675  -0.46339795],w=0.25,layer=3
   - photon num. 1: E=0.3033207941186153,pos=[ 0.86333588  0.8432589  -0.21715782],dir=[ 0.54044752 -0.59390596  0.59598003],w=0.25,layer=3
next photon to simulate: E=0.29231419885395826,pos=[ 0.86333588  0.8432589  -0.21715782],dir=[-0.59886105  0.6531675  -0.46339795],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.6660316700922847 vs 1.4416297014623014)
Photon is absorbed via photoeffect! (E_abs =0.07307854971348957)
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.3033207941186153,pos=[ 0.46447545  1.27828914 -0.52579553],dir=[ 0.54044752 -0.59390596  0.59598003],w=0.25,layer=3
next photon to simulate: E=0.3033207941186153,pos=[ 0.46447545  1.27828914 -0.52579553],dir=[ 0.54044752 -0.59390596  0.59598003],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (0.8830168321803585 vs 0.801595344122203)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.3033207941186153,pos=[ 0.          0.80221689 -0.04806072],dir=[ 0.54044752 -0.59390596  0.59598003],w=0.125,layer=4
   - photon num. 1: E=0.3033207941186153,pos=[ 0.          0.80221689 -0.04806072],dir=[ 0.54044752 -0.59390596  0.59598003],w=0.125,layer=4
next photon to simulate: E=0.3033207941186153,pos=[ 0.          0.80221689 -0.04806072],dir=[ 0.54044752 -0.59390596  0.59598003],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.8557037564668797 vs 1.6610228374040563)
Photon experiences Compoton scattering, preserves 63.83841784914554 % of initial energy!; E_abs = 0.013710699768228397
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.3033207941186153,pos=[0.46246297 0.29400933 0.46192163],dir=[ 0.54044752 -0.59390596  0.59598003],w=0.125,layer=4
   - photon num. 1: E=0.1936351959727881,pos=[0.46246297 0.29400933 0.46192163],dir=[ 0.8651923   0.35657453 -0.35255764],w=0.125,layer=4
next photon to simulate: E=0.3033207941186153,pos=[0.46246297 0.29400933 0.46192163],dir=[ 0.54044752 -0.59390596  0.59598003],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.6270528428879533 vs 0.8053190809371765)
Photon experiences Compoton scattering, preserves 73.03060071145582 % of initial energy!; E_abs = 0.01022547451137905
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.1936351959727881,pos=[ 0.80135212 -0.07840109  0.8356326 ],dir=[ 0.8651923   0.35657453 -0.35255764],w=0.125,layer=4
   - photon num. 1: E=0.2215169980275829,pos=[ 0.80135212 -0.07840109  0.8356326 ],dir=[0.80512641 0.46538427 0.36768049],w=0.125,layer=4
next photon to simulate: E=0.1936351959727881,pos=[ 0.80135212 -0.07840109  0.8356326 ],dir=[ 0.8651923   0.35657453 -0.35255764],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.02517189413922649 vs 0.11135506600650395)
Photon is absorbed via photoeffect! (E_abs =0.024204399496598514)
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.2215169980275829,pos=[ 0.82313065 -0.06942544  0.82675806],dir=[0.80512641 0.46538427 0.36768049],w=0.125,layer=4
next photon to simulate: E=0.2215169980275829,pos=[ 0.82313065 -0.06942544  0.82675806],dir=[0.80512641 0.46538427 0.36768049],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.010353537436372538 vs 0.09261280648668682)
Photon is absorbed via photoeffect! (E_abs =0.027689624753447863)
-->>Finish simulating 6-th photon


---------simulating photon number 7
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,layer=1
next photon to simulate: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,cl=1
 NO INTERACTION as: s_free > lam (1.216385343318476 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
next photon to simulate: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (1.1916641728143158 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=3)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 2: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
next photon to simulate: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 interaction takes place! as: s_free<lam (0.029661728204915416 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 80.44459291276709 % of initial energy!; E_abs = 0.0977770354361645
 ---photons to simulate (#=3)--:
   - photon num. 0: E=1,pos=[2.96617282e-02 1.82505306e-13 1.82505306e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=1,pos=[2.96617282e-02 1.82505306e-13 1.82505306e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 2: E=0.804445929127671,pos=[2.96617282e-02 1.82505306e-13 1.82505306e-13],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.5,layer=2
next photon to simulate: E=1,pos=[2.96617282e-02 1.82505306e-13 1.82505306e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.5213238764946514 vs 0.8680339380112012)
Photon is absorbed via photoeffect! (E_abs =0.25)
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[5.50985605e-01 2.34637694e-13 2.34637694e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=0.804445929127671,pos=[5.50985605e-01 2.34637694e-13 2.34637694e-13],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.5,layer=2
next photon to simulate: E=1,pos=[5.50985605e-01 2.34637694e-13 2.34637694e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.14372054929548955 vs 0.3467100615165498)
Photon experiences Compoton scattering, preserves 40.64268284570005 % of initial energy!; E_abs = 0.14839329288574987
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.804445929127671,pos=[6.94706154e-01 2.49009749e-13 2.49009749e-13],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.5,layer=2
   - photon num. 1: E=0.4064268284570005,pos=[6.94706154e-01 2.49009749e-13 2.49009749e-13],dir=[ 0.25370111  0.00949639 -0.96723604],w=0.25,layer=3
next photon to simulate: E=0.804445929127671,pos=[6.94706154e-01 2.49009749e-13 2.49009749e-13],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (1.7608629888685896 vs 0.23178135032790143)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.4064268284570005,pos=[ 0.         -0.11155344 -0.00858383],dir=[ 0.25370111  0.00949639 -0.96723604],w=0.25,layer=3
   - photon num. 1: E=0.804445929127671,pos=[ 0.         -0.11155344 -0.00858383],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.25,layer=3
   - photon num. 2: E=0.804445929127671,pos=[ 0.         -0.11155344 -0.00858383],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.25,layer=3
next photon to simulate: E=0.4064268284570005,pos=[ 0.         -0.11155344 -0.00858383],dir=[ 0.25370111  0.00949639 -0.96723604],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.12670630442803255 vs 3.538398644503648)
Photon experiences Compoton scattering, preserves 64.42348050774207 % of initial energy!; E_abs = 0.036148129961942624
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.804445929127671,pos=[ 0.03214553 -0.11035019 -0.13113873],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.25,layer=3
   - photon num. 1: E=0.804445929127671,pos=[ 0.03214553 -0.11035019 -0.13113873],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.25,layer=3
   - photon num. 2: E=0.26183430860923,pos=[ 0.03214553 -0.11035019 -0.13113873],dir=[ 0.40631159 -0.88730503 -0.21817579],w=0.25,layer=3
next photon to simulate: E=0.804445929127671,pos=[ 0.03214553 -0.11035019 -0.13113873],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (1.861195347044724 vs 0.9883189388210658)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=4)--:
   - photon num. 0: E=0.804445929127671,pos=[ 0.         -0.58601563 -0.16774028],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.25,layer=3
   - photon num. 1: E=0.26183430860923,pos=[ 0.         -0.58601563 -0.16774028],dir=[ 0.40631159 -0.88730503 -0.21817579],w=0.25,layer=3
   - photon num. 2: E=0.804445929127671,pos=[ 0.         -0.58601563 -0.16774028],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 3: E=0.804445929127671,pos=[ 0.         -0.58601563 -0.16774028],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
next photon to simulate: E=0.804445929127671,pos=[ 0.         -0.58601563 -0.16774028],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (1.7826393230691118 vs 1.0250239602156612)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=5)--:
   - photon num. 0: E=0.26183430860923,pos=[ 0.         -1.07934674 -0.20570118],dir=[ 0.40631159 -0.88730503 -0.21817579],w=0.25,layer=3
   - photon num. 1: E=0.804445929127671,pos=[ 0.         -1.07934674 -0.20570118],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 2: E=0.804445929127671,pos=[ 0.         -1.07934674 -0.20570118],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 3: E=0.804445929127671,pos=[ 0.         -1.07934674 -0.20570118],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 4: E=0.804445929127671,pos=[ 0.         -1.07934674 -0.20570118],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
next photon to simulate: E=0.26183430860923,pos=[ 0.         -1.07934674 -0.20570118],dir=[ 0.40631159 -0.88730503 -0.21817579],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.12808337739260148 vs 2.2093774293562403)
Photon experiences Compoton scattering, preserves 53.75830511171412 % of initial energy!; E_abs = 0.030269155524983247
 ---photons to simulate (#=5)--:
   - photon num. 0: E=0.804445929127671,pos=[ 0.05204176 -1.19299576 -0.23364587],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 1: E=0.804445929127671,pos=[ 0.05204176 -1.19299576 -0.23364587],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 2: E=0.804445929127671,pos=[ 0.05204176 -1.19299576 -0.23364587],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 3: E=0.804445929127671,pos=[ 0.05204176 -1.19299576 -0.23364587],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 4: E=0.14075768650929704,pos=[ 0.05204176 -1.19299576 -0.23364587],dir=[ 0.02569711  0.88908398 -0.45702225],w=0.25,layer=3
next photon to simulate: E=0.804445929127671,pos=[ 0.05204176 -1.19299576 -0.23364587],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.43807891391218917 vs 0.9656006453087934)
Photon is absorbed via photoeffect! (E_abs =0.10055574114095887)
 ---photons to simulate (#=4)--:
   - photon num. 0: E=0.804445929127671,pos=[ 0.43570259 -1.40383762 -0.24986975],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 1: E=0.804445929127671,pos=[ 0.43570259 -1.40383762 -0.24986975],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 2: E=0.804445929127671,pos=[ 0.43570259 -1.40383762 -0.24986975],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 3: E=0.14075768650929704,pos=[ 0.43570259 -1.40383762 -0.24986975],dir=[ 0.02569711  0.88908398 -0.45702225],w=0.25,layer=3
next photon to simulate: E=0.804445929127671,pos=[ 0.43570259 -1.40383762 -0.24986975],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.3010371662838394 vs 0.5275217313966043)
Photon is absorbed via photoeffect! (E_abs =0.10055574114095887)
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.804445929127671,pos=[ 0.69934497 -1.54872301 -0.2610184 ],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 1: E=0.804445929127671,pos=[ 0.69934497 -1.54872301 -0.2610184 ],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 2: E=0.14075768650929704,pos=[ 0.69934497 -1.54872301 -0.2610184 ],dir=[ 0.02569711  0.88908398 -0.45702225],w=0.25,layer=3
next photon to simulate: E=0.804445929127671,pos=[ 0.69934497 -1.54872301 -0.2610184 ],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.1401428028367578 vs 0.22648456511276477)
Photon experiences Compoton scattering, preserves 26.853806020263576 % of initial energy!; E_abs = 0.07355269747272741
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.804445929127671,pos=[ 0.82207926 -1.61617197 -0.26620847],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,layer=4
   - photon num. 1: E=0.14075768650929704,pos=[ 0.82207926 -1.61617197 -0.26620847],dir=[ 0.02569711  0.88908398 -0.45702225],w=0.25,layer=3
   - photon num. 2: E=0.21602434934585177,pos=[ 0.82207926 -1.61617197 -0.26620847],dir=[-0.44391615  0.66314419  0.60264271],w=0.125,layer=4
next photon to simulate: E=0.804445929127671,pos=[ 0.82207926 -1.61617197 -0.26620847],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (0.5805148458022917 vs 0.08634176227600698)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=4)--:
   - photon num. 0: E=0.14075768650929704,pos=[ 0.         -1.65772718 -0.26940607],dir=[ 0.02569711  0.88908398 -0.45702225],w=0.25,layer=3
   - photon num. 1: E=0.21602434934585177,pos=[ 0.         -1.65772718 -0.26940607],dir=[-0.44391615  0.66314419  0.60264271],w=0.125,layer=4
   - photon num. 2: E=0.804445929127671,pos=[ 0.         -1.65772718 -0.26940607],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.0625,layer=5
   - photon num. 3: E=0.804445929127671,pos=[ 0.         -1.65772718 -0.26940607],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.0625,layer=5
next photon to simulate: E=0.14075768650929704,pos=[ 0.         -1.65772718 -0.26940607],dir=[ 0.02569711  0.88908398 -0.45702225],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.0032263194713803654 vs 9.437179020122398)
Photon is absorbed via photoeffect! (E_abs =0.03518942162732426)
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.21602434934585177,pos=[ 8.29070845e-05 -1.65485871e+00 -2.70880568e-01],dir=[-0.44391615  0.66314419  0.60264271],w=0.125,layer=4
   - photon num. 1: E=0.804445929127671,pos=[ 8.29070845e-05 -1.65485871e+00 -2.70880568e-01],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.0625,layer=5
   - photon num. 2: E=0.804445929127671,pos=[ 8.29070845e-05 -1.65485871e+00 -2.70880568e-01],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.0625,layer=5
next photon to simulate: E=0.21602434934585177,pos=[ 8.29070845e-05 -1.65485871e+00 -2.70880568e-01],dir=[-0.44391615  0.66314419  0.60264271],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (0.09333663092292263 vs 0.00018676293802975854)
move to nex layer on left
Photon moves to next layer on left
 ---photons to simulate (#=4)--:
   - photon num. 0: E=0.804445929127671,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.0625,layer=5
   - photon num. 1: E=0.804445929127671,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.0625,layer=5
   - photon num. 2: E=0.21602434934585177,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[-0.44391615  0.66314419  0.60264271],w=0.0625,layer=3
   - photon num. 3: E=0.21602434934585177,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[-0.44391615  0.66314419  0.60264271],w=0.0625,layer=3
next photon to simulate: E=0.804445929127671,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.5735224018680377 vs 0.0)
escape on right
  escape on right; E_out=0.05027787057047944
 ---photons to simulate (#=3)--:
   - photon num. 0: E=0.804445929127671,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.0625,layer=5
   - photon num. 1: E=0.21602434934585177,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[-0.44391615  0.66314419  0.60264271],w=0.0625,layer=3
   - photon num. 2: E=0.21602434934585177,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[-0.44391615  0.66314419  0.60264271],w=0.0625,layer=3
next photon to simulate: E=0.804445929127671,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[ 0.87578018 -0.48128739 -0.03703415],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.31064641531850473 vs 0.0)
escape on right
  escape on right; E_out=0.05027787057047944
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.21602434934585177,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[-0.44391615  0.66314419  0.60264271],w=0.0625,layer=3
   - photon num. 1: E=0.21602434934585177,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[-0.44391615  0.66314419  0.60264271],w=0.0625,layer=3
next photon to simulate: E=0.21602434934585177,pos=[ 0.89769567 -1.65473486 -0.27076802],dir=[-0.44391615  0.66314419  0.60264271],w=0.0625,cl=3
 interaction takes place! as: s_free<lam (0.010737645371136754 vs 2.022218983231683)
Photon is absorbed via photoeffect! (E_abs =0.013501521834115736)
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.21602434934585177,pos=[ 0.89292905 -1.64761425 -0.26429705],dir=[-0.44391615  0.66314419  0.60264271],w=0.0625,layer=3
next photon to simulate: E=0.21602434934585177,pos=[ 0.89292905 -1.64761425 -0.26429705],dir=[-0.44391615  0.66314419  0.60264271],w=0.0625,cl=3
 interaction takes place! as: s_free<lam (0.01818790500261036 vs 2.011481337860546)
Photon is absorbed via photoeffect! (E_abs =0.013501521834115736)
-->>Finish simulating 7-th photon


---------simulating photon number 8
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,layer=1
next photon to simulate: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,cl=1
 interaction takes place! as: s_free<lam (0.6434702872760011 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 90.83633680839321 % of initial energy!; E_abs = 0.09163663191606786
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.9083633680839321,pos=[6.43470287e-01 6.43470287e-14 6.43470287e-14],dir=[ 0.94844979 -0.22041212  0.22773117],w=1.0,layer=1
next photon to simulate: E=0.9083633680839321,pos=[6.43470287e-01 6.43470287e-14 6.43470287e-14],dir=[ 0.94844979 -0.22041212  0.22773117],w=1.0,cl=1
 interaction takes place! as: s_free<lam (0.09233680743453737 vs 0.26804305361869313)
Photon experiences Compoton scattering, preserves 38.73978932024522 % of initial energy!; E_abs = 0.5564653130259332
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.3518980550579989,pos=[ 0.73104711 -0.02035215  0.02102797],dir=[0.06358967 0.59807759 0.79891148],w=1.0,layer=1
next photon to simulate: E=0.3518980550579989,pos=[ 0.73104711 -0.02035215  0.02102797],dir=[0.06358967 0.59807759 0.79891148],w=1.0,cl=1
 interaction takes place! as: s_free<lam (0.037195826787752455 vs 2.6206859871613104)
Photon experiences Compoton scattering, preserves 62.70828118763328 % of initial energy!; E_abs = 0.13122883319841636
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.22066922185958257,pos=[0.73341238 0.00189384 0.05074414],dir=[-0.42378866  0.81126366 -0.40280819],w=1.0,layer=1
next photon to simulate: E=0.22066922185958257,pos=[0.73341238 0.00189384 0.05074414],dir=[-0.42378866  0.81126366 -0.40280819],w=1.0,cl=1
 interaction takes place! as: s_free<lam (0.03553042548870974 vs 1.7306088052993371)
Photon is absorbed via photoeffect! (E_abs =0.22066922185958257)
-->>Finish simulating 8-th photon


---------simulating photon number 9
 ---photons to simulate (#=1)--:
   - photon num. 0: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,layer=1
next photon to simulate: E=1,pos=[0. 0. 0.],dir=[1.e+00 1.e-13 1.e-13],w=1.0,cl=1
 NO INTERACTION as: s_free > lam (2.83393949342601 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
next photon to simulate: E=1,pos=[0.00000000e+00 8.97695666e-14 8.97695666e-14],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (2.0493612995622903 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=3)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.5,layer=2
   - photon num. 1: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 2: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
next photon to simulate: E=1,pos=[0.00000000e+00 1.79539133e-13 1.79539133e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.5,cl=2
 NO INTERACTION as: s_free > lam (1.836643507124146 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=4)--:
   - photon num. 0: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 2: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 3: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
next photon to simulate: E=1,pos=[0.000000e+00 2.693087e-13 2.693087e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.5267279933138411 vs 0.8976956662161166)
Photon experiences Compoton scattering, preserves 89.05341335280585 % of initial energy!; E_abs = 0.02736646661798539
 ---photons to simulate (#=4)--:
   - photon num. 0: E=1,pos=[5.26727993e-01 3.21981499e-13 3.21981499e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=1,pos=[5.26727993e-01 3.21981499e-13 3.21981499e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 2: E=1,pos=[5.26727993e-01 3.21981499e-13 3.21981499e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 3: E=0.8905341335280584,pos=[5.26727993e-01 3.21981499e-13 3.21981499e-13],dir=[0.93718707 0.23670137 0.25622814],w=0.25,layer=3
next photon to simulate: E=1,pos=[5.26727993e-01 3.21981499e-13 3.21981499e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (0.3926626169394511 vs 0.3709676729022755)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=5)--:
   - photon num. 0: E=1,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=1,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 2: E=0.8905341335280584,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[0.93718707 0.23670137 0.25622814],w=0.25,layer=3
   - photon num. 3: E=1,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 4: E=1,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
next photon to simulate: E=1,pos=[0.00000000e+00 3.59078266e-13 3.59078266e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.8694297076861571 vs 0.8976956662161166)
Photon is absorbed via photoeffect! (E_abs =0.25)
 ---photons to simulate (#=4)--:
   - photon num. 0: E=1,pos=[8.69429708e-01 4.46021237e-13 4.46021237e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,layer=3
   - photon num. 1: E=0.8905341335280584,pos=[8.69429708e-01 4.46021237e-13 4.46021237e-13],dir=[0.93718707 0.23670137 0.25622814],w=0.25,layer=3
   - photon num. 2: E=1,pos=[8.69429708e-01 4.46021237e-13 4.46021237e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 3: E=1,pos=[8.69429708e-01 4.46021237e-13 4.46021237e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
next photon to simulate: E=1,pos=[8.69429708e-01 4.46021237e-13 4.46021237e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (0.5568112942014852 vs 0.0282659585299595)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=5)--:
   - photon num. 0: E=0.8905341335280584,pos=[0.00000000e+00 4.48847833e-13 4.48847833e-13],dir=[0.93718707 0.23670137 0.25622814],w=0.25,layer=3
   - photon num. 1: E=1,pos=[0.00000000e+00 4.48847833e-13 4.48847833e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[0.00000000e+00 4.48847833e-13 4.48847833e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 3: E=1,pos=[0.00000000e+00 4.48847833e-13 4.48847833e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 4: E=1,pos=[0.00000000e+00 4.48847833e-13 4.48847833e-13],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
next photon to simulate: E=0.8905341335280584,pos=[0.00000000e+00 4.48847833e-13 4.48847833e-13],dir=[0.93718707 0.23670137 0.25622814],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.855486710114707 vs 0.957861770072498)
Photon experiences Compoton scattering, preserves 41.152446091303865 % of initial energy!; E_abs = 0.13101438857581607
 ---photons to simulate (#=5)--:
   - photon num. 0: E=1,pos=[0.80175108 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[0.80175108 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[0.80175108 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 3: E=1,pos=[0.80175108 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 4: E=0.36647657922479426,pos=[0.80175108 0.20249487 0.21919977],dir=[-0.07578409  0.9954371   0.05798056],w=0.25,layer=3
next photon to simulate: E=1,pos=[0.80175108 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.00751434995246383 vs 0.09594458253174465)
Photon experiences Compoton scattering, preserves 21.577741533826753 % of initial energy!; E_abs = 0.09802782308271656
 ---photons to simulate (#=5)--:
   - photon num. 0: E=1,pos=[0.80926543 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[0.80926543 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=1,pos=[0.80926543 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 3: E=0.36647657922479426,pos=[0.80926543 0.20249487 0.21919977],dir=[-0.07578409  0.9954371   0.05798056],w=0.25,layer=3
   - photon num. 4: E=0.21577741533826753,pos=[0.80926543 0.20249487 0.21919977],dir=[-0.85718111 -0.50326693 -0.10937521],w=0.125,layer=4
next photon to simulate: E=1,pos=[0.80926543 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (0.6428492761689278 vs 0.08843023257928084)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=6)--:
   - photon num. 0: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 2: E=0.36647657922479426,pos=[0.         0.20249487 0.21919977],dir=[-0.07578409  0.9954371   0.05798056],w=0.25,layer=3
   - photon num. 3: E=0.21577741533826753,pos=[0.         0.20249487 0.21919977],dir=[-0.85718111 -0.50326693 -0.10937521],w=0.125,layer=4
   - photon num. 4: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
next photon to simulate: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 NO INTERACTION as: s_free > lam (5.750522519181028 vs 0.8976956662161166)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=7)--:
   - photon num. 0: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,layer=4
   - photon num. 1: E=0.36647657922479426,pos=[0.         0.20249487 0.21919977],dir=[-0.07578409  0.9954371   0.05798056],w=0.25,layer=3
   - photon num. 2: E=0.21577741533826753,pos=[0.         0.20249487 0.21919977],dir=[-0.85718111 -0.50326693 -0.10937521],w=0.125,layer=4
   - photon num. 3: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 6: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
next photon to simulate: E=1,pos=[0.         0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.1596517640026469 vs 0.8976956662161166)
Photon is absorbed via photoeffect! (E_abs =0.125)
 ---photons to simulate (#=6)--:
   - photon num. 0: E=0.36647657922479426,pos=[0.15965176 0.20249487 0.21919977],dir=[-0.07578409  0.9954371   0.05798056],w=0.25,layer=3
   - photon num. 1: E=0.21577741533826753,pos=[0.15965176 0.20249487 0.21919977],dir=[-0.85718111 -0.50326693 -0.10937521],w=0.125,layer=4
   - photon num. 2: E=1,pos=[0.15965176 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[0.15965176 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=1,pos=[0.15965176 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=1,pos=[0.15965176 0.20249487 0.21919977],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
next photon to simulate: E=0.36647657922479426,pos=[0.15965176 0.20249487 0.21919977],dir=[-0.07578409  0.9954371   0.05798056],w=0.25,cl=3
 interaction takes place! as: s_free<lam (0.05209084103625107 vs 2.106665915586124)
Photon experiences Compoton scattering, preserves 81.87445757343961 % of initial energy!; E_abs = 0.016606466962699323
 ---photons to simulate (#=6)--:
   - photon num. 0: E=0.21577741533826753,pos=[0.15570411 0.25434803 0.22222002],dir=[-0.85718111 -0.50326693 -0.10937521],w=0.125,layer=4
   - photon num. 1: E=1,pos=[0.15570411 0.25434803 0.22222002],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[0.15570411 0.25434803 0.22222002],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[0.15570411 0.25434803 0.22222002],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=1,pos=[0.15570411 0.25434803 0.22222002],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 5: E=0.30005071137399697,pos=[0.15570411 0.25434803 0.22222002],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.25,layer=3
next photon to simulate: E=0.21577741533826753,pos=[0.15570411 0.25434803 0.22222002],dir=[-0.85718111 -0.50326693 -0.10937521],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.02107147283638643 vs 0.18164668378435056)
Photon is absorbed via photoeffect! (E_abs =0.02697217691728344)
 ---photons to simulate (#=5)--:
   - photon num. 0: E=1,pos=[0.13764204 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[0.13764204 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[0.13764204 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=1,pos=[0.13764204 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 4: E=0.30005071137399697,pos=[0.13764204 0.24374345 0.21991533],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.25,layer=3
next photon to simulate: E=1,pos=[0.13764204 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (1.2951135397025482 vs 0.7600536278898005)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=4)--:
   - photon num. 0: E=1,pos=[0.89769567 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[0.89769567 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=1,pos=[0.89769567 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 3: E=0.30005071137399697,pos=[0.89769567 0.24374345 0.21991533],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.25,layer=3
next photon to simulate: E=1,pos=[0.89769567 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (0.10665986636131103 vs 0.0)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=3)--:
   - photon num. 0: E=1,pos=[0.89769567 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=1,pos=[0.89769567 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 2: E=0.30005071137399697,pos=[0.89769567 0.24374345 0.21991533],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.25,layer=3
next photon to simulate: E=1,pos=[0.89769567 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (1.91398282373583 vs 0.0)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=2)--:
   - photon num. 0: E=1,pos=[0.89769567 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,layer=5
   - photon num. 1: E=0.30005071137399697,pos=[0.89769567 0.24374345 0.21991533],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.25,layer=3
next photon to simulate: E=1,pos=[0.89769567 0.24374345 0.21991533],dir=[1.e+00 1.e-13 1.e-13],w=0.0625,cl=5
 NO INTERACTION as: s_free > lam (2.3171123503708997 vs 0.0)
escape on right
  escape on right; E_out=0.0625
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.30005071137399697,pos=[0.89769567 0.24374345 0.21991533],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.25,layer=3
next photon to simulate: E=0.30005071137399697,pos=[0.89769567 0.24374345 0.21991533],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.25,cl=3
 NO INTERACTION as: s_free > lam (0.6369208407157722 vs 0.0)
move to next layer on right
Photon moves to next layer on right
 ---photons to simulate (#=2)--:
   - photon num. 0: E=0.30005071137399697,pos=[0.         0.24374345 0.21991533],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.125,layer=4
   - photon num. 1: E=0.30005071137399697,pos=[0.         0.24374345 0.21991533],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.125,layer=4
next photon to simulate: E=0.30005071137399697,pos=[0.         0.24374345 0.21991533],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.14625233197237336 vs 1.6047913623034602)
Photon is absorbed via photoeffect! (E_abs =0.03750633892174962)
 ---photons to simulate (#=1)--:
   - photon num. 0: E=0.30005071137399697,pos=[0.08181131 0.35442271 0.17045063],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.125,layer=4
next photon to simulate: E=0.30005071137399697,pos=[0.08181131 0.35442271 0.17045063],dir=[ 0.55938466  0.75676917 -0.33821476],w=0.125,cl=4
 interaction takes place! as: s_free<lam (0.10608310144908616 vs 1.4585390303310868)
Photon is absorbed via photoeffect! (E_abs =0.03750633892174962)
-->>Finish simulating 9-th photon

~~~~~~~~~~~~~~~~~~FINISH SIMULATION~~~~~~~~~~~~~~~~

